# Cy3tic_web

## Description
Hello users, This is the devil can you crack my secrets ??

[START CTF](https://crypt.sumonnath.repl.co)

## Solution
The site shows a hash with a password field.

Using crackstation.net yields no result, and upon reloading, the hash changes.

### Find source code
A HTML comment on the source code suggests users to append `/?view=1` to the url. This allows the source code to be shown.

### PHP source
Below is an extract of part of the source code

```php
<?php
  sleep(1);
  if((isset($_SESSION['hash'])) && ($_POST['password'] == $_SESSION['hash'])) {
    done();
    }
  $hash = rand(13000000,13000050)."DSPH";
  $_SESSION['hash'] = $hash;
  for($i=0;$i<100;$i++) $hash = sha1($hash);
?>
```

As can be seen, a hash (ie the password) is generated by conacatenating an integer between `13000000` to `13000050`, and "DSPH", and looping it through sha-1 hashing 100 times.

### Generating all passwords
Since there are only 50 variations, we can write a quick and simple PHP script to generate all 50 hashed passwords.

Here is the script:
```php
<?php
for($j = 13000000; $j < 13000050; $j++){
    $hash = $j."DSPH";
    echo $hash;
    echo " ";
    for($i = 0; $i < 100; $i++) $hash = sha1($hash);
    echo $hash;
    echo "\n ";
}
```

Here are all the possible plaintext password, with its respective hashed string:
```
13000000DSPH 8c72aa8bdc37a49cc8c3c975e0c179308a2ba88e
13000001DSPH 493c062080dc281d3c01d48d7809ac8add39eab8
13000002DSPH e8ee4c60403bfd8e226de30a58ef2c44de4e69a6
13000003DSPH 4bb19cece507e834ab99217342391198f4c6031f
13000004DSPH 6600293128b63eb5bc047a20fc18ea32496f918c
13000005DSPH 4a778d13f4048208e1f79cb6087164a0125af063
13000006DSPH 0ac05f46369cb5b7acbf49055f17c3c344b19b3a
13000007DSPH 6f5706a7fc6192a803678c236344dfa04cd4238b
13000008DSPH 6bce2626267e5c2b7f9e2a314c37f5be1cd95850
13000009DSPH 4d4aea054d785c325d17bde87e0e614682265af6
13000010DSPH a9f2792cac462cd6366c3dce9a13eb9873564659
13000011DSPH aff1ef71a6b516fcb08057c82b0c20acc205c617
13000012DSPH 9575316bec1a9bd9467ea6f5d11b96ed09bee86f
13000013DSPH b0c73be4668edba545f08f65a1524e9b620fa79e
13000014DSPH 4620c20b7afb6e71655710f3769b1c9d79b878f7
13000015DSPH 1c1ace7a379443d171df5f3eeac902c39ebb6796
13000016DSPH 39f5eff5200f1daa8fe5b8fcf9b134725d74b30d
13000017DSPH 9a344d4ae921e1a258a1faf7373a7dfb002789cf
13000018DSPH 129d4168ac8be75ed5f4d0148d5bc0c68ecb0c31
13000019DSPH 7997a5b1429b5825d854c068d00f6c9cb4f86dd1
13000020DSPH 158dcafef0f55b8456ab22f05dd619d11ab760a7
13000021DSPH 7f67ffeff988ed9a65295e0823a4b9b04bc0bd9f
13000022DSPH b23dcfefd5bcc763ba79704d1aaa52bdf1afd461
13000023DSPH efb811e17ecf80a3ba858ff542df6961c0214317
13000024DSPH 06160ba343be50aaf1dd2f80bdadddc24e89bfba
13000025DSPH cc5d4e2b82462edb75fdc7968bcd3b6e403a6b27
13000026DSPH d0ba621a112fbae727fee60733c308c686245b40
13000027DSPH 12b412d8c1fcef21b5b099025549fef95e43f429
13000028DSPH eb63639c0ec9f488d432ad1e639c252918ef33cf
13000029DSPH 44ff93ee51fe90ef6b8b2223f218cafe0bf51d2f
13000030DSPH 86e6b53978acaba4401bd838b3aff9c74565ce84
13000031DSPH 2f765217d28560969c4ee5af31870fd00ee7c2b2
13000032DSPH aea339679a1691dd85855ef4a1b9c0944b3c63b2
13000033DSPH e087cd91b5d8bbfbf3123ef88e356dea41d7cd40
13000034DSPH 3815e4c378cbdc73932f1a276fcb39864b7ab783
13000035DSPH bcc8fea9da993a838eb7efef19f4e957211e9854
13000036DSPH 74b2e9f575370a9b2c1e42129511d4144e0b725f
13000037DSPH 05e3d8d3c6c3328de8c5b03c58ab0cdc46e8492e
13000038DSPH 1bc820d1b6f3be623ea6bbd4ca3e30875794b869
13000039DSPH 12ee12408a32d92fd98a5381c69c4de0cc6911f2
13000040DSPH fb9a3ee56e4309d8fbd0475161dc6884353324a7
13000041DSPH b595086f3dfc41bd9ba5f6cbb60dfdf56230d8dc
13000042DSPH 3613b1b1f33c71533ca8433b00dd62589a0bfe99
13000043DSPH 1567609e2d90a7969a66b6cde8b83a07e65b8820
13000044DSPH f23138f607f64242ac4e09fe8a90057bf3718545
13000045DSPH ec64cbbd08f98388b65eb80ce344be7be7ed251d
13000046DSPH 8f5789f0025131f64b52f1ce7ae73b8f2377bb89
13000047DSPH d83eec317a2549b424171205aa8aeb342cf6401a
13000048DSPH 32b5ed52490ba7af64dc594ea56ecf27c12f9c1f
13000049DSPH d3c77f2dcbf142bcc27183ec5c4da936d5525e66
```

### Capturing the flag
Reloading the site again, we copy the hash and find the associated password. For us, we had `13000014DSPH`. Entering it gave us the flag in an alert.

> DSPH{Cryp70_1s_f3n}